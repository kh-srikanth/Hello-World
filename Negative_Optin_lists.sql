
drop table if exists #sms_optout_null
select a.customer_id, a.first_name, a.last_name,a.primary_phone_number,a.primary_phone_number_valid, a.secondary_phone_number, a.secondary_phone_number_valid,primary_email, primary_email_valid
into #sms_optout_null
from auto_customers.customer.customers a(nolock)
inner join  auto_customers.customer.vehicles b(nolock) on a.customer_id = b.customer_id
where 
a.account_id ='AEACFC4E-FADA-4FA1-A24D-EACED71020BB' 
and a.is_deleted =0
and b.is_deleted =0
and (len(a.primary_phone_number) <> 0 or len(a.secondary_phone_number) <> 0)
and a.do_not_sms is null

select customer_id,count(*) from #sms_optout_null group by customer_id having count(*) > 1

select * from #sms_optout_null where customer_id ='3454572'

select primary_email,primary_email_valid,* from auto_customers.customer.customers a(nolock) where primary_email like '%,%'
and a.account_id ='AEACFC4E-FADA-4FA1-A24D-EACED71020BB' 
and a.is_deleted =0
and customer_id = 3461805


--Brother Power Sports Lists
drop table if exists #sms_camp
select distinct
		a.customer_id
		,a.first_name
		,a.last_name
		,case	when a.primary_phone_number_valid = 1 then a.primary_phone_number
				when a.primary_phone_number_valid =0 and a.secondary_phone_number_valid=1 then a.secondary_phone_number
				else '' end as phone_number
		,isnull(last_service_date,'') as last_service_date
		,isnull(purchase_date,'') as purchase_date
		,case	when last_service_date is null and purchase_date is not null then purchase_date
				when last_service_date is not null and purchase_date is null then last_service_date
				when last_service_date is not null and purchase_date is not null and convert(date,last_service_date) > convert(date,purchase_date) then last_service_date
				when last_service_date is not null and purchase_date is not null and convert(date,last_service_date) <= convert(date,purchase_date) then purchase_date
				else null end as s_date

	into #sms_camp
from auto_customers.customer.customers a(nolock)
inner join  auto_customers.customer.vehicles b(nolock) on a.customer_id = b.customer_id
where  a.account_id ='AEACFC4E-FADA-4FA1-A24D-EACED71020BB'
and a.is_deleted =0
and isnull(a.fleet_flag,0) = 0
and b.is_deleted =0
and do_not_sms is null


select phone_number,count(*) from #sms_camp where len(phone_number) <> 0 group by phone_number having count(*) > 1


select * from (
select *,row_number() over (partition by phone_number order by s_date desc) as rnk from #sms_camp
where len(phone_number) <> 0 
) as a where rnk =1

--Email List (Bros)
drop table if exists #email_camp
select distinct
		a.customer_id
		,a.first_name
		,a.last_name
		,a.primary_email
		,last_service_date
		,purchase_date
		,case	when last_service_date is null and purchase_date is not null then purchase_date
				when last_service_date is not null and purchase_date is null then last_service_date
				when last_service_date is not null and purchase_date is not null and convert(date,last_service_date) > convert(date,purchase_date) then last_service_date
				when last_service_date is not null and purchase_date is not null and convert(date,last_service_date) <= convert(date,purchase_date) then purchase_date
				else null end as s_date

	into #email_camp
from auto_customers.customer.customers a(nolock)
inner join  auto_customers.customer.vehicles b(nolock) on a.customer_id = b.customer_id
where  a.account_id ='AEACFC4E-FADA-4FA1-A24D-EACED71020BB'
and a.is_deleted =0
and isnull(a.fleet_flag,0) = 0
and b.is_deleted =0
and do_not_email is null
and primary_email_valid =1




select * from (
select *,row_number() over (partition by primary_email order by s_date desc) as rnk from #email_camp where len(primary_email)<>0
) as a where rnk =1



use auto_customers
----D2
drop table if exists #d2_email
select distinct
		a.customer_id
		,a.first_name
		,a.last_name
		,a.primary_email
		,a.primary_email_valid
		,case when do_not_email=0 then 'Yes' when do_not_email =1 then 'No' else null end as email_optin
		,isnull(last_service_date,'') as last_service_date
		,isnull(purchase_date,'') as purchase_date
		,case	when last_service_date is null and purchase_date is not null then purchase_date
				when last_service_date is not null and purchase_date is null then last_service_date
				when last_service_date is not null and purchase_date is not null and convert(date,last_service_date) > convert(date,purchase_date) then last_service_date
				when last_service_date is not null and purchase_date is not null and convert(date,last_service_date) <= convert(date,purchase_date) then purchase_date
				else null end as s_date

into #d2_email

from auto_customers.customer.customers a(nolock)
inner join  auto_customers.customer.vehicles b(nolock) on a.customer_id = b.customer_id
where  a.account_id ='d51e5da3-9099-42c6-b311-de6bbc9d825c'
and a.is_deleted =0
and isnull(a.fleet_flag,0) = 0
and b.is_deleted =0
and primary_email_valid =1




select customer_id as [CustomerID], first_name as [First Name], last_name as [Last Name], primary_email as [Email], email_optin  as [Email Optin] 
from (
select *,row_number() over (partition by primary_email order by s_date desc) as rnk from #d2_email
) as a where rnk =1

select primary_email,count(*) from #d2_email group by primary_email having count(*) =2


/*
select *
from auto_customers.customer.customers a(nolock)
inner join  auto_customers.customer.vehicles b(nolock) on a.customer_id = b.customer_id
where  a.account_id ='d51e5da3-9099-42c6-b311-de6bbc9d825c'
and a.is_deleted =0
and b.is_deleted =0
and a.customer_id ='3475874'

select * from auto_customers.customer.customers a(nolock) where a.customer_id = '3475874'


select top 10 * from clictell_auto_etl.etl.cdklgt_customer (nolock) where customerid = '37989390'
select * from clictell_auto_etl.etl.cdkLgt_Service_Details (nolock) where custID = '37989390'
select * from clictell_auto_etl.etl.cdkLgt_Deals_Details (nolock) where custID = '37989390'

select vin, count(*) from 
auto_customers.customer.vehicles b(nolock) 
where  account_id ='d51e5da3-9099-42c6-b311-de6bbc9d825c' and is_deleted =0 and is_valid_vin=1
group by vin having count(*) >1
*/

drop table if exists #d2_sms
select distinct
		a.customer_id,
		a.first_name,
		a.last_name,
		case	when a.primary_phone_number_valid = 1 then a.primary_phone_number
				when a.primary_phone_number_valid =0 and a.secondary_phone_number_valid=1 then a.secondary_phone_number
				else '' end as phone_number
		,case when do_not_sms=0 then 'Yes' when do_not_sms =1 then 'No' else null end as email_optin
		,isnull(last_service_date,'') as last_service_date
		,isnull(purchase_date,'') as purchase_date
		,case	when last_service_date is null and purchase_date is not null then purchase_date
				when last_service_date is not null and purchase_date is null then last_service_date
				when last_service_date is not null and purchase_date is not null and convert(date,last_service_date) > convert(date,purchase_date) then last_service_date
				when last_service_date is not null and purchase_date is not null and convert(date,last_service_date) <= convert(date,purchase_date) then purchase_date
				else null end as s_date
		,make
		,birth_date
		,'' as gender
		,primary_email
		,zip
			

into #d2_sms
from auto_customers.customer.customers a(nolock)
inner join  auto_customers.customer.vehicles b(nolock) on a.customer_id = b.customer_id
where  a.account_id ='d51e5da3-9099-42c6-b311-de6bbc9d825c'
and a.is_deleted =0
and isnull(a.fleet_flag,0) = 0
and b.is_deleted =0
and (primary_phone_number_valid =1 or secondary_phone_number_valid =1)
and (b.make like '%honda%' or b.make like '%kawasaki%'or b.make like '%polaris%')


select * from #d2_sms b where len(b.make) =0
--(b.make not like '%honda%' and b.make not like '%kawasaki%'and b.make not like '%polaris%') 
--and b.make like '%pol%'

select 
	customer_id as [Customer ID]
	,first_name as [First Name]
	,last_name as [Last Name]
	,phone_number as [Phone Number]
	,email_optin as [Email Optin]
	,make as [Make]
	into #result
from (
select *,row_number() over (partition by phone_number order by s_date desc) as rnk from #d2_sms where len(phone_number) <>0
) as a where rnk =1


select [Phone Number],count(*) from #result  group by [Phone Number] having count(*) > 1

select make, count(*) from #result group by make
order by Make
--6091




select 
	phone_number as [phone number]
	,first_name as [First Name]
	,last_name as [Last Name]
	,gender
	,birth_date
	,primary_email
	,zip
	into #lime
from (
select *,row_number() over (partition by phone_number order by s_date desc) as rnk from #d2_sms where len(phone_number) <>0
) as a where rnk =1


select * from #lime




select a.customer_id,first_name, last_name,fleet_flag, count(*)
from auto_customers.customer.customers a(nolock)
inner join  auto_customers.customer.vehicles b(nolock) on a.customer_id = b.customer_id
where  a.account_id ='d51e5da3-9099-42c6-b311-de6bbc9d825c'
and a.is_deleted =0
and b.is_deleted =0
group by a.customer_id,first_name,last_name,fleet_flag
having count(*) > 5
order by last_name

select fleet_flag,* from auto_customers.customer.customers a(nolock)
where isnull(fleet_flag,0) =0
and a.account_id ='d51e5da3-9099-42c6-b311-de6bbc9d825c'
and a.is_deleted =0


--last_name like '%REDLINE POWERSPORTS%'
--and a.account_id ='d51e5da3-9099-42c6-b311-de6bbc9d825c'
--and a.is_deleted =0



select distinct
	secondary_phone_number as [secondary phone number]
	,first_name as [First Name]
	,last_name as [Last Name]
	,'' as gender
	,birth_date
	,primary_email	
	,zip
	,a.customer_id
	into #sec_no_bro
from auto_customers.customer.customers a(nolock)
where isnull(fleet_flag,0) =0
and a.account_id ='AEACFC4E-FADA-4FA1-A24D-EACED71020BB'
and a.is_deleted =0
and secondary_phone_number in (
'2053054989'
,'2062268717'
,'2062295060'
,'2063105294'
,'2063137678'
,'2063305817'
,'2063728051'
,'2063911436'
,'2063969595'
,'2063995165'
,'2064189270'
,'2064555154'
,'2064917554'
,'2065023961'
,'2065521731'
,'2065523220'
,'2065795551'
,'2065796667'
,'2065955843'
,'2066179804'
,'2066503412'
,'2067307690'
,'2067346995'
,'2067908902'
,'2067952015'
,'2068028551'
,'2068225445'
,'2068239111'
,'2068428096'
,'2068537723'
,'2068989000'
,'2069204106'
,'2069306558'
,'2069725216'
,'2084572276'
,'2089463525'
,'2247236365'
,'2253641255'
,'2284243505'
,'2532081335'
,'2532190782'
,'2532191130'
,'2532199711'
,'2532229476'
,'2532251140'
,'2532254469'
,'2532254567'
,'2532257652'
,'2532257713'
,'2532266971'
,'2532277672'
,'2532501096'
,'2532731500'
,'2532731977'
,'2532904972'
,'2533022771'
,'2533075989'
,'2533248408'
,'2533504817'
,'2533505987'
,'2533589864'
,'2533635735'
,'2533767288'
,'2533815040'
,'2534056330'
,'2534262260'
,'2534425358'
,'2534550019'
,'2535095777'
,'2535098444'
,'2535142608'
,'2535148439'
,'2535491940'
,'2535498058'
,'2535648678'
,'2535765513'
,'2536705704'
,'2536770865'
,'2536776439'
,'2536782414'
,'2536866225'
,'2536917216'
,'2537208094'
,'2537328610'
,'2537400303'
,'2537403701'
,'2537782708'
,'2538204915'
,'2538512059'
,'2538517637'
,'2538616577'
,'2538845971'
,'2539052222'
,'2539064878'
,'2539614048'
,'2539853321'
,'2539888635'
,'2548555332'
,'2605712437'
,'2813849845'
,'2816380604'
,'3152694300'
,'3343440289'
,'3365428911'
,'3523480455'
,'3602014482'
,'3602042635'
,'3602046560'
,'3602048364'
,'3602048396'
,'3602048439'
,'3602288351'
,'3602501445'
,'3602504210'
,'3602504328'
,'3602650759'
,'3602658752'
,'3602682297'
,'3602713599'
,'3602714195'
,'3602714258'
,'3602718582'
,'3602719388'
,'3602755614'
,'3602755795'
,'3602756711'
,'3602776335'
,'3602778660'
,'3602807592'
,'3602861083'
,'3602862036'
,'3602864930'
,'3602865570'
,'3602866515'
,'3602867824'
,'3602868681'
,'3603062180'
,'3603283586'
,'3603286596'
,'3603289389'
,'3603370078'
,'3603405212'
,'3603405318'
,'3603406036'
,'3603406636'
,'3603407115'
,'3603407755'
,'3603499353'
,'3603722543'
,'3603722629'
,'3603730223'
,'3603734118'
,'3603736758'
,'3603736777'
,'3603749481'
,'3603771291'
,'3603795797'
,'3604050494'
,'3604205858'
,'3604340739'
,'3604341522'
,'3604341911'
,'3604342454'
,'3604344762'
,'3604345067'
,'3604400000'
,'3604402827'
,'3604403674'
,'3604404111'
,'3604406035'
,'3604409479'
,'3604421570'
,'3604430261'
,'3604517415'
,'3604612525'
,'3604612932'
,'3604615408'
,'3604615802'
,'3604615853'
,'3604616140'
,'3604715319'
,'3604715575'
,'3604715766'
,'3604717456'
,'3604735391'
,'3604737724'
,'3604738540'
,'3604771879'
,'3604777659'
,'3604792644'
,'3604793096'
,'3604796877'
,'3604817305'
,'3604892901'
,'3604900499'
,'3604900706'
,'3605002303'
,'3605003613'
,'3605090910'
,'3605091589'
,'3605093251'
,'3605093625'
,'3605093720'
,'3605093968'
,'3605097982'
,'3605099220'
,'3605160017'
,'3605160743'
,'3605310333'
,'3605310579'
,'3605350098'
,'3605353811'
,'3605359200'
,'3605359476'
,'3605361531'
,'3605362234'
,'3605365034'
,'3605365700'
,'3605506123'
,'3605506716'
,'3605510350'
,'3605512203'
,'3605513802'
,'3605515357'
,'3605518450'
,'3605891626'
,'3605911600'
,'3606200278'
,'3606201941'
,'3606201987'
,'3606204011'
,'3606205278'
,'3606207369'
,'3606209820'
,'3606210622'
,'3606214170'
,'3606215280'
,'3606217443'
,'3606263201'
,'3606270041'
,'3606325994'
,'3606330118'
,'3606330202'
,'3606335481'
,'3606339569'
,'3606493899'
,'3606495432'
,'3606495775'
,'3606496010'
,'3606498371'
,'3606839696'
,'3606893197'
,'3606893973'
,'3606894235'
,'3606896043'
,'3606896074'
,'3606896941'
,'3606897418'
,'3606897656'
,'3606899872'
,'3606926032'
,'3606928121'
,'3606975089'
,'3606979462'
,'3607101170'
,'3607101225'
,'3607101243'
,'3607102121'
,'3607102246'
,'3607103300'
,'3607103871'
,'3607104806'
,'3607106166'
,'3607107537'
,'3607311138'
,'3607311325'
,'3607312795'
,'3607314787'
,'3607315792'
,'3607316502'
,'3607317139'
,'3607319108'
,'3607319403'
,'3607319828'
,'3607622518'
,'3607693948'
,'3607699276'
,'3607755885'
,'3607875825'
,'3607893258'
,'3607902743'
,'3607922369'
,'3607973692'
,'3608014764'
,'3608015435'
,'3608015556'
,'3608086419'
,'3608104025'
,'3608135201'
,'3608135651'
,'3608138665'
,'3608211029'
,'3608409544'
,'3608507775'
,'3608508085'
,'3608653288'
,'3608657795'
,'3608658624'
,'3608713283'
,'3608714161'
,'3608740778'
,'3608744574'
,'3608748048'
,'3608748283'
,'3608760943'
,'3608762890'
,'3608768302'
,'3608769048'
,'3608950712'
,'3608950739'
,'3608984547'
,'3609006589'
,'3609078066'
,'3609084718'
,'3609085578'
,'3609088549'
,'3609123452'
,'3609175933'
,'3609199867'
,'3609279785'
,'3609304429'
,'3609790739'
,'3609793651'
,'3609810384'
,'3609812775'
,'3609813116'
,'3609814231'
,'3609818334'
,'3609905903'
,'3609908949'
,'4082040583'
,'4152024973'
,'4253018213'
,'4253464102'
,'4253615026'
,'4253959001'
,'4254449316'
,'4256266348'
,'4256980249'
,'4256988696'
,'4257603775'
,'4257910483'
,'4259317242'
,'4259412644'
,'4259413308'
,'4259480877'
,'4259710586'
,'4439421890'
,'4843418190'
,'4847976326'
,'5033879410'
,'5034075629'
,'5036325553'
,'5038612636'
,'5044159118'
,'5052419761'
,'5093788936'
,'5094380000'
,'5094386024'
,'5096630075'
,'5096690047'
,'5097585343'
,'5097700075'
,'5097860260'
,'5098601777'
,'5099331737'
,'5099398309'
,'5099488257'
,'5106736903'
,'5362948432'
,'5413212816'
,'5614445454'
,'5622288653'
,'5635704298'
,'6015138395'
,'6035686451'
,'6048364995'
,'6082206862'
,'6086922220'
,'6129864731'
,'6192614821'
,'6199426561'
,'6262559998'
,'6308884451'
,'6506830392'
,'6512613674'
,'7046146070'
,'7049629317'
,'7073266227'
,'7076956963'
,'7122045569'
,'7193223138'
,'7202453949'
,'7572885663'
,'7577590788'
,'7577889178'
,'7607133006'
,'7742891726'
,'8082713734'
,'8084920184'
,'8086812000'
,'8087294206'
,'8087723796'
,'8087798592'
,'8168350456'
,'8169355480'
,'8185885211'
,'8307337566'
,'8312512511'
,'8324149346'
,'8438263723'
,'8457876336'
,'8504615382'
,'8582206890'
,'9045093024'
,'9084421788'
,'9094356239'
,'9126024200'
,'9129803249'
,'9139087831'
,'9162238665'
,'9169040131'
,'9202957169'
,'9252120306'
,'9412246929'
,'9492412552'
,'9739877588'
,'9802980171'

)
order by secondary_phone_number


select * from 
(select *,ROW_NUMBER() over (partition by [secondary phone number] order by zip desc) as rnk from #sec_no_bro) as a
where rnk =1 order by [secondary phone number]




select distinct
	primary_phone_number as [primary phone number]
	,first_name as [First Name]
	,last_name as [Last Name]
	,'' as gender
	,birth_date
	,primary_email	
	,zip
	,a.customer_id
	
from auto_customers.customer.customers a(nolock)
where isnull(fleet_flag,0) =0
and a.account_id ='AEACFC4E-FADA-4FA1-A24D-EACED71020BB'
and a.is_deleted =0
and primary_phone_number in (
'2028024622'
,'2062266877'
,'2062280863'
,'2062281450'
,'2062296090'
,'2062298657'
,'2062347877'
,'2062455950'
,'2062501586'
,'2062565157'
,'2062659912'
,'2062903360'
,'2062906562'
,'2062913366'
,'2063083139'
,'2063345832'
,'2063513860'
,'2063519108'
,'2063716322'
,'2063717127'
,'2063756976'
,'2063837678'
,'2063906058'
,'2063914379'
,'2063954477'
,'2063955021'
,'2063961808'
,'2064028948'
,'2064050968'
,'2064062262'
,'2064128733'
,'2064199430'
,'2064229634'
,'2064237074'
,'2064373305'
,'2064579912'
,'2064595249'
,'2064650203'
,'2064683296'
,'2064883964'
,'2064964142'
,'2065018828'
,'2065026111'
,'2065502685'
,'2065508918'
,'2065510917'
,'2065511309'
,'2065521216'
,'2065561284'
,'2065572218'
,'2065650938'
,'2065792500'
,'2066017949'
,'2066052050'
,'2066063783'
,'2066179955'
,'2067146061'
,'2067150281'
,'2067154936'
,'2067171710'
,'2067185523'
,'2067437775'
,'2067553225'
,'2067699089'
,'2067870962'
,'2067906042'
,'2067933769'
,'2067990850'
,'2068189901'
,'2068197007'
,'2068410369'
,'2068422000'
,'2068567011'
,'2068613115'
,'2068760874'
,'2068833688'
,'2068861451'
,'2068907410'
,'2069095987'
,'2069138232'
,'2069141034'
,'2069150854'
,'2069153095'
,'2069281240'
,'2069317330'
,'2069319336'
,'2069406304'
,'2069472160'
,'2069483141'
,'2069489441'
,'2069603176'
,'2069637107'
,'2069729007'
,'2069791555'
,'2069927150'
,'2069996650'
,'2082155290'
,'2084063862'
,'2085145058'
,'2087312080'
,'2087837946'
,'2088196111'
,'2095593331'
,'2096798037'
,'2102689690'
,'2133932964'
,'2173695223'
,'2179262828'
,'2197160322'
,'2313423006'
,'2353559484'
,'2532048952'
,'2532080582'
,'2532087560'
,'2532088759'
,'2532096964'
,'2532127562'
,'2532188464'
,'2532199414'
,'2532210849'
,'2532212971'
,'2532222025'
,'2532230289'
,'2532242519'
,'2532244144'
,'2532246664'
,'2532246950'
,'2532252994'
,'2532253360'
,'2532254620'
,'2532261475'
,'2532264179'
,'2532278230'
,'2532286892'
,'2532290277'
,'2532297685'
,'2532298934'
,'2532328632'
,'2532352379'
,'2532457435'
,'2532491852'
,'2532498592'
,'2532576648'
,'2532607280'
,'2532658333'
,'2532688477'
,'2532784137'
,'2532792505'
,'2532821415'
,'2532824285'
,'2532824867'
,'2532831353'
,'2532837100'
,'2532981501'
,'2533044497'
,'2533063037'
,'2533063137'
,'2533063147'
,'2533070960'
,'2533120096'
,'2533134565'
,'2533188685'
,'2533206518'
,'2533241198'
,'2533294377'
,'2533344406'
,'2533359119'
,'2533418846'
,'2533433864'
,'2533472757'
,'2533474492'
,'2533480263'
,'2533483065'
,'2533501334'
,'2533586729'
,'2533653144'
,'2533655925'
,'2533708823'
,'2533772935'
,'2533773373'
,'2533890650'
,'2533892036'
,'2533898516'
,'2533979754'
,'2534055306'
,'2534059493'
,'2534145629'
,'2534260934'
,'2534265602'
,'2534265774'
,'2534320834'
,'2534390550'
,'2534411985'
,'2534418461'
,'2534419766'
,'2534423998'
,'2534496483'
,'2534993313'
,'2535092330'
,'2535093398'
,'2535093449'
,'2535093717'
,'2535142418'
,'2535145210'
,'2535147101'
,'2535333661'
,'2535338809'
,'2535368215'
,'2535486132'
,'2535495624'
,'2535499188'
,'2535763712'
,'2535767765'
,'2535792941'
,'2535903623'
,'2536062371'
,'2536062440'
,'2536063009'
,'2536200561'
,'2536256467'
,'2536493792'
,'2536512583'
,'2536517264'
,'2536533587'
,'2536772823'
,'2536776632'
,'2536831619'
,'2536866294'
,'2536867748'
,'2536913821'
,'2536919065'
,'2537405525'
,'2537534623'
,'2537536828'
,'2537972574'
,'2537978981'
,'2538203198'
,'2538203832'
,'2538304083'
,'2538431930'
,'2538513322'
,'2538577508'
,'2538616802'
,'2538782260'
,'2538806793'
,'2538808487'
,'2538825552'
,'2538839654'
,'2538841642'
,'2538883773'
,'2538889071'
,'2539060580'
,'2539065305'
,'2539066427'
,'2539487439'
,'2539617650'
,'2539735930'
,'2539851096'
,'2539853200'
,'2539885800'
,'3012328008'
,'3035201417'
,'3038035615'
,'3038290933'
,'3039107151'
,'3039475777'
,'3072623386'
,'3076967269'
,'3102595750'
,'3103013903'
,'3104150751'
,'3146166744'
,'3147062586'
,'3163057744'
,'3177498484'
,'3215919479'
,'3312050479'
,'3344473800'
,'3375324889'
,'3379626552'
,'3528437359'
,'3602026081'
,'3602040001'
,'3602040471'
,'3602040994'
,'3602041125'
,'3602041200'
,'3602041617'
,'3602042823'
,'3602043612'
,'3602044725'
,'3602044767'
,'3602046630'
,'3602049611'
,'3602049669'
,'3602083512'
,'3602227319'
,'3602285055'
,'3602286000'
,'3602290144'
,'3602292778'
,'3602293362'
,'3602296069'
,'3602299494'
,'3602391684'
,'3602597264'
,'3602650343'
,'3602650558'
,'3602654295'
,'3602656934'
,'3602657360'
,'3602658142'
,'3602658282'
,'3602710442'
,'3602711192'
,'3602711638'
,'3602711894'
,'3602713052'
,'3602713289'
,'3602713669'
,'3602714441'
,'3602715499'
,'3602716268'
,'3602717166'
,'3602717327'
,'3602717564'
,'3602717868'
,'3602719285'
,'3602719489'
,'3602719626'
,'3602719793'
,'3602719884'
,'3602759140'
,'3602759220'
,'3602759650'
,'3602771179'
,'3602771476'
,'3602774437'
,'3602776114'
,'3602776378'
,'3602777896'
,'3602860896'
,'3602860994'
,'3602861159'
,'3602863081'
,'3602863874'
,'3602864512'
,'3602866510'
,'3602867929'
,'3602868028'
,'3602868376'
,'3602974708'
,'3602977469'
,'3603007054'
,'3603012633'
,'3603013959'
,'3603019614'
,'3603021117'
,'3603108424'
,'3603166115'
,'3603224600'
,'3603265465'
,'3603289297'
,'3603330239'
,'3603370011'
,'3603370538'
,'3603379367'
,'3603379544'
,'3603401428'
,'3603401958'
,'3603403486'
,'3603404354'
,'3603404746'
,'3603405389'
,'3603405781'
,'3603405999'
,'3603406152'
,'3603406168'
,'3603406262'
,'3603406532'
,'3603407335'
,'3603407412'
,'3603407751'
,'3603623626'
,'3603715902'
,'3603772870'
,'3603878518'
,'3603888922'
,'3603908224'
,'3603936093'
,'3603961789'
,'3603998960'
,'3604125916'
,'3604200646'
,'3604274556'
,'3604340178'
,'3604340185'
,'3604341843'
,'3604342920'
,'3604344799'
,'3604345221'
,'3604346889'
,'3604347719'
,'3604372574'
,'3604400557'
,'3604400765'
,'3604402041'
,'3604402504'
,'3604403144'
,'3604404732'
,'3604407042'
,'3604408797'
,'3604408813'
,'3604527678'
,'3604576353'
,'3604583344'
,'3604600967'
,'3604601485'
,'3604603343'
,'3604604087'
,'3604607525'
,'3604608358'
,'3604608890'
,'3604609839'
,'3604611352'
,'3604615902'
,'3604626003'
,'3604630654'
,'3604639628'
,'3604700785'
,'3604708441'
,'3604710887'
,'3604711729'
,'3604711824'
,'3604713181'
,'3604714075'
,'3604714878'
,'3604715517'
,'3604715851'
,'3604716507'
,'3604718520'
,'3604721435'
,'3604733390'
,'3604733451'
,'3604733903'
,'3604736264'
,'3604737211'
,'3604737958'
,'3604738224'
,'3604739018'
,'3604761157'
,'3604779617'
,'3604804659'
,'3604815099'
,'3604817860'
,'3604819278'
,'3604904739'
,'3604908038'
,'3605090285'
,'3605091569'
,'3605091847'
,'3605092322'
,'3605092520'
,'3605092612'
,'3605092890'
,'3605093171'
,'3605093230'
,'3605093826'
,'3605094586'
,'3605095209'
,'3605096035'
,'3605096440'
,'3605096956'
,'3605098183'
,'3605098949'
,'3605099083'
,'3605163350'
,'3605167743'
,'3605168432'
,'3605299409'
,'3605310171'
,'3605313222'
,'3605314691'
,'3605350460'
,'3605350525'
,'3605352897'
,'3605352977'
,'3605354040'
,'3605359532'
,'3605359563'
,'3605360027'
,'3605361274'
,'3605361800'
,'3605365613'
,'3605366040'
,'3605366208'
,'3605500120'
,'3605503115'
,'3605503147'
,'3605503755'
,'3605503887'
,'3605506897'
,'3605508191'
,'3605508609'
,'3605510675'
,'3605510988'
,'3605511045'
,'3605511341'
,'3605512167'
,'3605513233'
,'3605513335'
,'3605513767'
,'3605515021'
,'3605515777'
,'3605517304'
,'3605517470'
,'3605518470'
,'3605525226'
,'3605525630'
,'3605525805'
,'3605804944'
,'3605808976'
,'3605810745'
,'3605813697'
,'3605817681'
,'3605819242'
,'3605827595'
,'3605827626'
,'3605890115'
,'3605904448'
,'3605912251'
,'3605934649'
,'3605982654'
,'3605983599'
,'3606025513'
,'3606132441'
,'3606161235'
,'3606200077'
,'3606200715'
,'3606201134'
,'3606202398'
,'3606202791'
,'3606204514'
,'3606206595'
,'3606206799'
,'3606207384'
,'3606208378'
,'3606208516'
,'3606209471'
,'3606209560'
,'3606209893'
,'3606211911'
,'3606212211'
,'3606212997'
,'3606215332'
,'3606215671'
,'3606216489'
,'3606216641'
,'3606216751'
,'3606216909'
,'3606216950'
,'3606217915'
,'3606218267'
,'3606218771'
,'3606219513'
,'3606280857'
,'3606301143'
,'3606320065'
,'3606330636'
,'3606336120'
,'3606337265'
,'3606400048'
,'3606405306'
,'3606405340'
,'3606409062'
,'3606430878'
,'3606439767'
,'3606491638'
,'3606491647'
,'3606493966'
,'3606496740'
,'3606498499'
,'3606499740'
,'3606626607'
,'3606626867'
,'3606709259'
,'3606740284'
,'3606743406'
,'3606749479'
,'3606749567'
,'3606812959'
,'3606890451'
,'3606891143'
,'3606891369'
,'3606892435'
,'3606893004'
,'3606893337'
,'3606893513'
,'3606896204'
,'3606898678'
,'3606921098'
,'3606921563'
,'3606929837'
,'3606982119'
,'3607011333'
,'3607012221'
,'3607014915'
,'3607016540'
,'3607100586'
,'3607100962'
,'3607101318'
,'3607101630'
,'3607102666'
,'3607102816'
,'3607103045'
,'3607103687'
,'3607103957'
,'3607105580'
,'3607105837'
,'3607106997'
,'3607108284'
,'3607121313'
,'3607204714'
,'3607208424'
,'3607310850'
,'3607310857'
,'3607311419'
,'3607311883'
,'3607315233'
,'3607315321'
,'3607315838'
,'3607316183'
,'3607316346'
,'3607316960'
,'3607319046'
,'3607319089'
,'3607319346'
,'3607319544'
,'3607319979'
,'3607324745'
,'3607399329'
,'3607496233'
,'3607690807'
,'3607700046'
,'3607712285'
,'3607741966'
,'3607746017'
,'3607746076'
,'3607746278'
,'3607798849'
,'3607905637'
,'3607915177'
,'3607916736'
,'3607918371'
,'3607921864'
,'3607980535'
,'3608010435'
,'3608010707'
,'3608010803'
,'3608011148'
,'3608011178'
,'3608011339'
,'3608011482'
,'3608012002'
,'3608012902'
,'3608013230'
,'3608013930'
,'3608014163'
,'3608014219'
,'3608014577'
,'3608014714'
,'3608014745'
,'3608015033'
,'3608015705'
,'3608016628'
,'3608017182'
,'3608018910'
,'3608081058'
,'3608084486'
,'3608087619'
,'3608094302'
,'3608131666'
,'3608131946'
,'3608135160'
,'3608138250'
,'3608184466'
,'3608211114'
,'3608240505'
,'3608270926'
,'3608307904'
,'3608350382'
,'3608421374'
,'3608502040'
,'3608507544'
,'3608600439'
,'3608601383'
,'3608650056'
,'3608650449'
,'3608650516'
,'3608650649'
,'3608650678'
,'3608650741'
,'3608650980'
,'3608652492'
,'3608652875'
,'3608652939'
,'3608656299'
,'3608656828'
,'3608656980'
,'3608701018'
,'3608711393'
,'3608764421'
,'3608801979'
,'3608880293'
,'3608950054'
,'3608952702'
,'3609007651'
,'3609007736'
,'3609009479'
,'3609080607'
,'3609081686'
,'3609083103'
,'3609084776'
,'3609084857'
,'3609087105'
,'3609088112'
,'3609088239'
,'3609120264'
,'3609123970'
,'3609174710'
,'3609183733'
,'3609196438'
,'3609304181'
,'3609304214'
,'3609304701'
,'3609321374'
,'3609328624'
,'3609329077'
,'3609411325'
,'3609511267'
,'3609793529'
,'3609796516'
,'3609797556'
,'3609799795'
,'3609801487'
,'3609810858'
,'3609811383'
,'3609813844'
,'3609814150'
,'3609816000'
,'3609816625'
,'3609817414'
,'3609829024'
,'3609900551'
,'3609900660'
,'3609901049'
,'3609901360'
,'3609904950'
,'3609905805'
,'3609907178'
,'3609911692'
,'3609940782'
,'3615003084'
,'4025871800'
,'4027795794'
,'4028850713'
,'4062233391'
,'4065796795'
,'4087590215'
,'4089633118'
,'4128741218'
,'4137729509'
,'4159489657'
,'4173224339'
,'4178964040'
,'4252142650'
,'4252171099'
,'4252180640'
,'4252199122'
,'4252390600'
,'4252400740'
,'4252437655'
,'4252468430'
,'4252751455'
,'4252752643'
,'4252758826'
,'4252902238'
,'4253142553'
,'4253441842'
,'4253591070'
,'4254120410'
,'4255015292'
,'4255030962'
,'4255187448'
,'4255821128'
,'4256816286'
,'4257371679'
,'4257484256'
,'4257604522'
,'4257651628'
,'4257653190'
,'4257729235'
,'4257747676'
,'4257801316'
,'4257853905'
,'4258306208'
,'4258766970'
,'4258767917'
,'4258901902'
,'4258904788'
,'4259418444'
,'4323124541'
,'4348417533'
,'4356408740'
,'4357091292'
,'4439772754'
,'4802069140'
,'4802961670'
,'4803131670'
,'4805240441'
,'4846952829'
,'5026673139'
,'5035374622'
,'5036496691'
,'5036646289'
,'5036760046'
,'5037548596'
,'5038871616'
,'5039608240'
,'5039982401'
,'5052900561'
,'5072362463'
,'5074021117'
,'5076962323'
,'5085057334'
,'5092125974'
,'5092804654'
,'5093225022'
,'5094329238'
,'5095394480'
,'5096079845'
,'5096307984'
,'5096704147'
,'5096797606'
,'5096799298'
,'5098287144'
,'5098338869'
,'5098409923'
,'5098443763'
,'5098601063'
,'5099459478'
,'5099993730'
,'5106912886'
,'5129137741'
,'5155710084'
,'5302157458'
,'5303133847'
,'5403684387'
,'5408480666'
,'5412072510'
,'5412525940'
,'5413400033'
,'5415707142'
,'5416011826'
,'5417718878'
,'5593002283'
,'5597790125'
,'5705754906'
,'5713754437'
,'5865529531'
,'6023096279'
,'6029994145'
,'6085131757'
,'6128497925'
,'6144832300'
,'6154967463'
,'6156930980'
,'6164434976'
,'6168227539'
,'6192076355'
,'6264886502'
,'6266762353'
,'6319535331'
,'6502786113'
,'6512367844'
,'6617096319'
,'6619937667'
,'7023767618'
,'7024972611'
,'7044533400'
,'7073043876'
,'7073675632'
,'7074782849'
,'7075533728'
,'7075995498'
,'7077220660'
,'7082187383'
,'7086389443'
,'7132927673'
,'7134446037'
,'7135151104'
,'7138226448'
,'7192327227'
,'7206330609'
,'7208406317'
,'7275155785'
,'7327669500'
,'7349342755'
,'7572896940'
,'7573535751'
,'7573763134'
,'7575068476'
,'7579692303'
,'7608893747'
,'7747709454'
,'7752324894'
,'7752332377'
,'7818087671'
,'7853073922'
,'7873489863'
,'7873995767'
,'7875529596'
,'8016518339'
,'8052179642'
,'8052763857'
,'8056657283'
,'8057059968'
,'8062011567'
,'8082718052'
,'8082854999'
,'8083426754'
,'8083668203'
,'8083696225'
,'8085578590'
,'8087546193'
,'8087546647'
,'8087827323'
,'8088663233'
,'8126036101'
,'8135579468'
,'8136102034'
,'8138637945'
,'8142620144'
,'8313457117'
,'8326335655'
,'8433007220'
,'8434252670'
,'8434571389'
,'8436702082'
,'8437303912'
,'8438608944'
,'8502387687'
,'8505985513'
,'8506918666'
,'8508654544'
,'8566309766'
,'8572333164'
,'8607018636'
,'8607052111'
,'8609106991'
,'9032838881'
,'9035080907'
,'9036035548'
,'9043120043'
,'9046149612'
,'9072993345'
,'9072993396'
,'9075682259'
,'9077501786'
,'9095195796'
,'9104743195'
,'9106227577'
,'9122270893'
,'9125802704'
,'9134887373'
,'9154870273'
,'9168718499'
,'9189381662'
,'9194183223'
,'9252009222'
,'9258092083'
,'9316273550'
,'9413046762'
,'9516628628'
,'9545493432'
,'9563697126'
,'9567569657'
,'9703097157'
,'9712197975'
,'9712753869'
,'9715063553'
,'9718030678'
,'9729743214'
,'9797778665'
,'9894006125'
)
order by [primary phone number]

select * from auto_customers.customer.customers (nolock) 

select * from auto_customers.list.lists (nolock) where list_name like '%service%' and  account_id ='AEACFC4E-FADA-4FA1-A24D-EACED71020BB'
and is_deleted =0 --list_id = 2313


select distinct * from 
auto_customers.customer.customers a(nolock) 
left outer join  auto_customers.customer.vehicles b (nolock) on a.customer_id =b.customer_id -- and b.is_deleted=0
where list_ids like '%2313%' 
and a.account_id = 'AEACFC4E-FADA-4FA1-A24D-EACED71020BB' 
and a.is_deleted =0 
and (a.do_not_email=0 or a.do_not_sms=0 or a.do_not_mail =0) 
and (a.primary_phone_number_valid =1 or a.primary_email_valid =1 or a.secondary_phone_number_valid =1)
and b.is_valid_vin =1

and primary_email like 'CLARENCETOUGAW@ AOL.COM'


